[build]
  command = "npm install --legacy-peer-deps && npm run build"
  publish = ".next/standalone"
  functions = ".next/serverless"

[build.environment]
  NEXT_PUBLIC_STRIPE_KEY = "your_stripe_key"
  NEXTAUTH_SECRET = "your_nextauth_secret"
  NEXTAUTH_URL = "https://your-site.netlify.app"
  MONGODB_URI = "your_mongodb_uri"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[functions]
  node_bundler = "esbuild"
  external_node_modules = ["mongodb", "stripe", "next-auth"] 